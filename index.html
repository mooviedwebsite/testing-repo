<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub CMS - Home</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
   <header class="header">
    <div class="container">
        <div class="logo">
            <h1>GitHub CMS</h1>
        </div>
        <nav class="nav">
            <a href="index.html">Home</a>
            <a href="search.html">Search</a>
            <a href="bookmarks.html">Bookmarks</a>
            <!-- User Account Icon (shows when logged in) -->
            <div class="user-account" style="display: none;"></div>
            <!-- Login Link (shows when not logged in) -->
            <a href="auth.html" class="login-link admin-link">Login</a>
        </nav>
    </div>
</header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h2 class="hero-title">Discover Amazing Content</h2>
            <p class="hero-subtitle">Powered by GitHub, Built for Creators</p>
        </div>
    </section>

    <!-- Posts Grid -->
    <main class="main">
        <div class="container">
            <div class="section-header">
                <h3>Latest Posts</h3>
                <div class="filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="Action">Action</button>
                    <button class="filter-btn" data-filter="Drama">Drama</button>
                    <button class="filter-btn" data-filter="Sci-Fi">Sci-Fi</button>
                    <button class="filter-btn" data-filter="Horror">Horror</button>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>Loading posts...</p>
            </div>

            <!-- Posts Container -->
            <div id="posts-grid" class="posts-grid">
                <!-- Cards will be injected here by JavaScript -->
            </div>

            <!-- Load More -->
            <div class="load-more-container">
                <button id="load-more" class="btn-load-more">Load More</button>
            </div>
        </div>
    </main>

   <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 GitHub CMS. Built with ❤️ and GitHub Pages</p>
        </div>
    </footer>


    <script>
// Display posts - WITH BOOKMARK BUTTONS
function displayPosts() {
    const postsGrid = document.getElementById('posts-grid');
    
    const startIndex = 0;
    const endIndex = currentPage * postsPerPage;
    displayedPosts = filteredPosts.slice(startIndex, endIndex);
    
    postsGrid.innerHTML = displayedPosts.map(post => createPostCard(post)).join('');
    
    updateLoadMoreButton();
}

// Create post card HTML - WITH BOOKMARK BUTTON
function createPostCard(post) {
    const isBookmarked = UserAuth.isBookmarked(post.id);
    
    return `
        <div class="post-card">
            ${UserAuth.currentUser ? `
                <button class="bookmark-btn ${isBookmarked ? 'bookmarked' : ''}" 
                        onclick="handleBookmark(event, '${post.id}')"
                        title="${isBookmarked ? 'Remove bookmark' : 'Add bookmark'}">
                </button>
            ` : ''}
            
            <div class="post-card-image" onclick="navigateToPost('${post.id}', '${post.slug}')">
                <img src="${post.thumbnail}" alt="${post.title}" loading="lazy">
                <div class="post-card-overlay">
                    <span class="category">${post.category}</span>
                    <span class="rating">⭐ ${post.rating}</span>
                </div>
            </div>
            <div class="post-card-content" onclick="navigateToPost('${post.id}', '${post.slug}')">
                <h3 class="post-card-title">${post.title}</h3>
                <div class="post-card-meta">
                    <span>${post.year}</span>
                    <span>${post.tags.slice(0, 2).map(t => '#' + t).join(' ')}</span>
                </div>
            </div>
        </div>
    `;
}

// Handle bookmark button click
function handleBookmark(event, postId) {
    event.stopPropagation();
    
    const post = allPosts.find(p => p.id === postId);
    if (!post) return;

    const isBookmarked = UserAuth.toggleBookmark(post);
    
    const btn = event.target.closest('.bookmark-btn');
    if (isBookmarked) {
        btn.classList.add('bookmarked');
        btn.title = 'Remove bookmark';
        showToast('✅ Added to bookmarks');
    } else {
        btn.classList.remove('bookmarked');
        btn.title = 'Add bookmark';
        showToast('❌ Removed from bookmarks');
    }
}

// Toast notification
function showToast(message) {
    // Remove existing toasts
    document.querySelectorAll('.toast').forEach(t => t.remove());
    
    const toast = document.createElement('div');
    toast.className = 'toast';
    toast.textContent = message;
    document.body.appendChild(toast);

    setTimeout(() => toast.classList.add('show'), 100);
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
    }, 2000);
}
    </script>    
    <!-- Scripts - CORRECT ORDER -->
    <script src="js/google-sheets-api.js"></script>
    <script src="js/github-api.js"></script>
    <script src="js/user-auth.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
